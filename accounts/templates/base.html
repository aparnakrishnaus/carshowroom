{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{% block title %}Car Showroom{% endblock %}</title>

  <!-- CSS -->
  <link rel="stylesheet" href="{% static 'css/bootstrap.css' %}">
  <link rel="stylesheet" href="{% static 'css/style.css' %}?v=9">

  <!-- Google Fonts -->
  <link
    href="https://fonts.googleapis.com/css2?family=Nunito:wght@300;400&family=Rajdhani:wght@500;700&family=Oswald&family=Open+Sans&display=swap"
    rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;500;600&display=swap" rel="stylesheet">

  <!-- Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">

  <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Playfair Display:wght@700&display=swap" rel="stylesheet">


  <style>
    li {
      text-transform: capitalize;
    }

    .toast-container {
      position: fixed;
      top: 20px;
      right: 20px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      z-index: 99999;
    }

    .toast-msg {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 10px 14px;
      border-radius: 6px;
      min-width: 240px;
      font-size: 0.9rem;
      color: #000;
      background: #e0e0e0;
      box-shadow: 0 3px 8px rgba(0, 0, 0, 0.25);
      opacity: 0;
      transform: translateY(-10px);
      animation: toast-in 0.3s ease forwards, toast-out 0.5s ease 4s forwards;
      border-left: 4px solid #eee9e9;
    }

    .toast-success {
      background: #f5f5f5;
      color: #000;
      border-left-color: #a0a0a0;
    }

    .toast-warning {
      background: #fafafa;
      color: #000;
      border-left-color: #c0c0c0;
    }

    .toast-danger,
    .toast-error {
      background: #dcdcdc;
      color: #000;
      border-left-color: #999;
    }

    .toast-info {
      background: #eeeeee;
      color: #000;
      border-left-color: #bbb;
    }

    @keyframes toast-in {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes toast-out {
      from {
        opacity: 1;
        transform: translateY(0);
      }

      to {
        opacity: 0;
        transform: translateY(-20px);
      }
    }

.position-relative {
  position: relative;
  width: 100%;
  max-width: 600px;
  margin: 0 auto;
}

.search-input {
  width: 100%;
  padding: 0.5em 1rem 0.5rem 2.5rem;
  border: 1px solid #333;
  border-radius: 25px;
  background: #1a1a1a;
  color: #eee;
  font-size: 1rem;
  outline: none;
  display: block;
  margin: 0 auto;
  box-shadow: none;
}

.position-relative .fa-search {
  position: absolute;
  top: 50%;
  left: 12px;
  transform: translateY(-50%);
  color: #ccc;
  pointer-events: none;
  font-size: 1rem;
  z-index: 5;
}

.position-relative .fa-search::after {
  content: '✦';
  position: absolute;
  top: -6px;
  left: 10px;
  color: #fff;
  font-size: 0.7rem;
  opacity: 0;
  animation: sparkleBW 1.5s linear infinite;
}

@keyframes sparkleBW {
  0%, 100% {
    opacity: 0;
    transform: scale(0);
  }
  50% {
    opacity: 1;
    transform: scale(1.2) rotate(20deg);
  }
}

.autocomplete-suggestions {
  position: absolute;
  top: 100%;
  left: 0;
  right: 0;
  background: #fff;
  border-radius: 8px;
  max-height: 250px;
  overflow-y: auto;
  z-index: 1000;
  color: #000;
}

.autocomplete-suggestions .suggestion-item {
  padding: 10px 12px;
  cursor: pointer;
}

.autocomplete-suggestions .suggestion-item:hover {
  background: #f0f0f0;
}

input::placeholder {
  color: rgb(117, 116, 116) !important;
}

@media (max-width: 768px) {
  .position-relative {
    max-width: 90%;
  }

  .search-input {
    font-size: 0.95rem;
    padding: 0.45em 1rem 0.45rem 2.3rem;
  }

  .position-relative .fa-search {
    left: 10px;
    font-size: 0.9rem;
  }

  .autocomplete-suggestions {
    max-height: 200px;
  }
}


@media (max-width: 480px) {
  .position-relative {
    max-width: 95%;
  }

  .search-input {
    font-size: 0.9rem;
    padding: 0.4em 0.9rem 0.4rem 2.2rem;
    border-radius: 20px;
  }

  .position-relative .fa-search {
    left: 8px;
    font-size: 0.85rem;
  }

  .position-relative .fa-search::after {
    font-size: 0.6rem;
    left: 8px;
  }

  .autocomplete-suggestions .suggestion-item {
    padding: 8px 10px;
    font-size: 0.9rem;
  }
}
.nav-search-container {
  flex: 1;
  min-width: 0;
}
.info-p .info{
  color: #ccc !important;
  text-decoration: none !important;
}
.info-p .info:hover{
  color: white !important;
  text-decoration: none !important;
}

.scroll-top-btn {
    border: none;
    background: #333;
    color: white;
    padding: 10px 12px;
    border-radius: 50%;
    cursor: pointer;
    transition: 0.3s;
}

.scroll-top-btn:hover {
    background: #555;
}


  </style>

</head>

<body>

  <!-- msg -->
  {% if messages %}
  <div class="toast-container">
    {% for message in messages %}
    <div class="toast-msg toast-{{ message.tags }}">
      <i
        class="fa-solid 
      {% if message.tags == 'success' %}fa-circle-check{% elif message.tags == 'warning' %}fa-triangle-exclamation
      {% elif message.tags == 'danger' or message.tags == 'error' %}fa-circle-xmark{% else %}fa-circle-info{% endif %}">
      </i>
      <span>{{ message }}</span>
    </div>
    {% endfor %}
  </div>
  {% endif %}

  <!-- nav -->
  <nav class="navbar navbar-expand-lg modern-navbar">
    <div class="container-fluid">

      <!-- Left: Logo -->
      <a class="navbar-brand fw-bold" href="{% url 'home' %}">PL</a>

      <!-- Center: Search -->
      <form class="d-flex w-100 nav-search-container" action="{% url 'car_list' %}" method="get">
        <div class="position-relative">
          <input type="text" id="searchInput" name="q" class="form-control search-input "
            placeholder="Search cars by name or brand..." value="{{ query|default:'' }}" autocomplete="off">
          <i class="fas fa-search"></i>
          <div id="suggestions" class="autocomplete-suggestions"></div>
        </div>
      </form>

      <!-- Right: Sidebar Toggle -->
      <button class="btn menu-btn" id="openSidebar">
        <i class="fas fa-bars"></i>
      </button>
    </div>
  </nav>

  <!-- Sidebar -->
  <div id="sidebarNav" class="sidebar">
    <button class="close-btn" id="closeSidebar"><i class="fas fa-times"></i></button>
    <ul class="sidebar-links">

      <!-- Home -->
      <li class="sidebar-title"><a href="{% url 'home' %}"><i class="fas fa-home me-2"></i> Home</a></li>
      <li class="sidebar-title"><a href="{% url 'about' %}"> <i class="fas fa-info-circle me-2"></i> About Us</a></li>
      <li class="sidebar-title"><a href="{% url 'contact' %}"> <i class="fas fa-envelope me-2"></i> Contact Us</a></li>

      <!-- spear parts -->
      <li class="sidebar-title"><a href="{% url 'spare_parts_list' %}"><i class="fas fa-cogs me-2"></i> Spare Parts</a>
      </li>


      <!-- Services -->
      <li class="sidebar-title dropdown-toggle">Services</li>
      <ul class="dropdown-content">
        <li><a href="{% url 'services_list' %}">All Services</a></li>
        {% for category in categories %}
        <li><a href="{% url 'services_by_category' category %}">{{ category }}</a></li>
        {% endfor %}

      </ul>

      <hr>

      <!-- Models -->
      <li class="sidebar-title dropdown-toggle">Models</li>
      <ul class="dropdown-content">
        <li><a href="{% url 'car_list' %}">All Cars</a></li>
        {% for brand in brands %}
        <li><a href="{% url 'car_brand_list' brand %}">{{ brand }}</a></li>
        {% endfor %}
      </ul>
      <hr>

      <!-- Profile -->
      <li class="sidebar-title dropdown-toggle">Profile</li>
      <ul class="dropdown-content">
        {% if user.is_authenticated %}
        <li><a href="{% url 'profile' %}"><i class="fas fa-user-circle me-2"></i> My Profile</a></li>
        <li><a href="{% url 'logout' %}"><i class="fas fa-sign-out-alt me-2"></i> Logout</a></li>
        {% else %}
        <li><a href="{% url 'login' %}"><i class="fas fa-sign-in-alt me-2"></i> Login</a></li>
        <li><a href="{% url 'register' %}"><i class="fas fa-user-plus me-2"></i> Register</a></li>
        {% endif %}
      </ul>
    </ul>
  </div>


  <!-- Main Content -->
  <main>
    {% block content %}{% endblock %}
  </main>



  <!-- Footer -->
  <footer class="footer">
    <div class="footer-container">

      <!-- Brand -->
      <div class="footer-brand">
        <h2>Prestige Lane</h2>
      </div>

      <!-- Footer Links + Contact -->
      <div class="footer-content">

        <!-- Quick Links -->
        <div class="footer-section">
          <h3>Quick Links</h3>
          <ul>
            <li><a href="{% url 'home' %}">Home</a></li>
            <li><a href="{% url 'services_list' %}">Services</a></li>
            <li><a href="{% url 'car_list' %}">Models</a></li>
            <li><a href="{% url 'about' %}">About</a></li>
            <li><a href="{% url 'contact' %}">Contact</a></li>
          </ul>
        </div>

        <!-- Contact Info -->
        <div class="footer-section" >
          <h3>Contact</h3>
          <p class="info-p">Email: <a href="https://mail.google.com/mail/?view=cm&fs=1&to=info@prestigelane.com"  class="info">info@prestigelane.com</a></p>
        <p class="info-p">Phone: <a href="tel:+911234567890" class="info">+91 12345 67890</a></p>
        <p class="info-p">Address: 
        <a href="https://www.google.com/maps/search/?api=1&query=123+Luxury+Street+India" target="_blank" class="info">
            123 Luxury Street, India
        </a>
        </div>
        

        <!-- Newsletter -->
        <div class="footer-section">
          <h3>Newsletter</h3>
          <p>Subscribe to our newsletter for latest updates.</p> 

      <form class="newsletter-form" method="POST" action="{% url 'subscribe_newsletter' %}">
    {% csrf_token %}

    <input type="email" name="email" placeholder="Enter your email"
        {% if request.user.is_authenticated %}
            value="{{ request.user.email }}"
        {% endif %}
        required>

    {% if is_subscribed %}
        <button type="submit">Unsubscribe</button>
    {% else %}
        <button type="submit" >Subscribe</button>
    {% endif %}
</form>

        </div>

      </div>

      <!-- Social Icons -->
     <div class="social-icons">
    {% for platform, link in social_links.items %}
        <a href="{{ link }}" target="_blank" rel="noopener noreferrer"><i class="fab fa-{{ platform }}"></i></a>
    {% endfor %}
</div>

      <!-- Copyright -->
      <p class="copyright">© 2025 Prestige Lane. All rights reserved.</p>
      <p class="copyright">Designed by Aparna Krishna u s</p>

    </div>
  </footer>



  <!-- JS -->
  <script src="{% static 'js/bootstrap.js' %}"></script>
  <script src="{% static 'js/script.js' %}?v8"></script>
  <script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js"></script>


  <script>
// toast msg
    document.addEventListener("DOMContentLoaded", function () {
      setTimeout(() => {
        document.querySelectorAll(".toast-msg").forEach(toast => toast.remove());
      }, 5000);
    });


// search
    const input = document.getElementById('searchInput');
    const suggestions = document.getElementById('suggestions');
    const form = input.closest('form');

    input.addEventListener('input', function () {
      const query = this.value.trim();
      if (!query) {
        suggestions.innerHTML = '';
        return;
      }

      fetch(`/autocomplete/?q=${query}`)
        .then(res => res.json())
        .then(data => {
          suggestions.innerHTML = '';
          data.forEach(item => {

            if (item.type !== 'Car') return;

            const div = document.createElement('div');
            div.classList.add('suggestion-item');
            div.textContent = item.label;

            div.addEventListener('click', () => {

              input.value = item.value;
              suggestions.innerHTML = '';
              form.submit();
            });

            suggestions.appendChild(div);
          });
        });
    });

    // Hide suggestions when clicking outside
    document.addEventListener('click', function (e) {
      if (!input.contains(e.target) && !suggestions.contains(e.target)) {
        suggestions.innerHTML = '';
      }
    });



  </script>

</body>

</html>